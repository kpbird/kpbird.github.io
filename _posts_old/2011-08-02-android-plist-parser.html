---
layout: post
title: Android Plist Parser
date: '2011-08-02T12:02:00.000+05:30'
author: Ketan Parmar
tags:
- plist
- android plist parser
- plist parser
- Andorid
modified_time: '2011-08-02T12:03:33.442+05:30'
thumbnail: http://4.bp.blogspot.com/-4FIrHtHwcGE/TjeaMLmUNqI/AAAAAAAADPY/12knmyb9Udg/s72-c/plistParser
blogger_id: tag:blogger.com,1999:blog-17114597.post-2915068368496474825
blogger_orig_url: http://www.kpbird.com/2011/08/android-plist-parser.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-4FIrHtHwcGE/TjeaMLmUNqI/AAAAAAAADPY/12knmyb9Udg/s1600/plistParser" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-4FIrHtHwcGE/TjeaMLmUNqI/AAAAAAAADPY/12knmyb9Udg/s320/plistParser" width="213" /></a></div><br /><br />The Android-PList-Parser is designed to work with valid PList XMLs  only.  Before you start getting into the code, you want to be certain  that the PList XML you're working with is valid according to the DTD).  If it's valid, proceed to the next  paragraph.  you may want to write code from scratch instead of  trying to modify this code (since it's algorithm relies on the  assumption of validity). <br /><br />The basic rule for the algorithm is that elements are  treated in two different ways:  ones that can have children (Dict and  Array), and ones that can't.  Elements that can have children are pushed  onto a ArrayList method is used.  With these concepts in mind, reading the  code should be a little easier.<br /><br />This is very basic parser. you require to modify as per your requirement.<br /><br />Let's me show you the example which I have prepare specially for my Plist problem. There are two main file 1. DataModel.java and 2. ParsePlist.java<br /><br />1. DataMode.java - A model class holds the value of Plist.<br />2. ParsePlist.java - Class which parse the plist.<br />3. Sample.plist &nbsp;- Plist file placed in Asset folder.<br />4. PlistParser.java - Activity has button to trigger the parsing event. &nbsp;On Parse Button click, Application will fetch plist file from assets and pass the XML string content to ParsePlist class.<br /><br /><span style="font-size: large;"><a href="http://quicknews4you.com/kpbird/PlistParser.zip">Download Source</a> &nbsp;</span><br /><br /><a name='more'></a><br />1. sample.plist - Asmple plist file <br /><pre class="brush: xml;"><array><br /> <dict><br />  <key>gameid</key><br />  <string>1</string><br />  <key>drawid</key><br />  <string>5544</string><br />  <key>dname</key><br />  <string>9623</string><br />  <key>date</key><br />  <string>9999-01-01 00:00:00</string><br />  <key>prize</key><br />  <string>1490000.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>2</string><br />  <key>drawid</key><br />  <string>5546</string><br />  <key>dname</key><br />  <string>753</string><br />  <key>date</key><br />  <string>9999-01-01 00:00:00</string><br />  <key>prize</key><br />  <string>20030000.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5545</string><br />  <key>dname</key><br />  <string>3185</string><br />  <key>date</key><br />  <string>2012-01-28 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5505</string><br />  <key>dname</key><br />  <string>3183</string><br />  <key>date</key><br />  <string>2012-01-21 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5498</string><br />  <key>dname</key><br />  <string>3181</string><br />  <key>date</key><br />  <string>2012-01-14 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5485</string><br />  <key>dname</key><br />  <string>3179</string><br />  <key>date</key><br />  <string>2012-01-07 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5479</string><br />  <key>dname</key><br />  <string>3177</string><br />  <key>date</key><br />  <string>2011-12-31 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5472</string><br />  <key>dname</key><br />  <string>3175</string><br />  <key>date</key><br />  <string>2011-12-24 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5434</string><br />  <key>dname</key><br />  <string>3173</string><br />  <key>date</key><br />  <string>2011-12-17 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /> <dict><br />  <key>gameid</key><br />  <string>11</string><br />  <key>drawid</key><br />  <string>5405</string><br />  <key>dname</key><br />  <string>3171</string><br />  <key>date</key><br />  <string>2011-12-10 00:00:00</string><br />  <key>prize</key><br />  <string>0.00</string><br />  <key>sels</key><br />  <string></string><br /> </dict><br /></array>    <br /><br /></pre><br />2. PlistParser.java - Activity has button to trigger Plist parsing.<br /><br /><pre class="brush: java">package com.kpbird.plistparser;<br /><br />import java.io.BufferedReader;<br />import java.io.IOException;<br />import java.io.InputStreamReader;<br />import java.util.ArrayList;<br />import java.util.Iterator;<br /><br />import com.kpbird.plist.DataModel;<br />import com.kpbird.plist.ParsePlist;<br /><br />import android.app.Activity;<br />import android.os.Bundle;<br />import android.util.Log;<br />import android.view.View;<br />import android.view.View.OnClickListener;<br />import android.widget.Button;<br />import android.widget.Toast;<br /><br />public class PlistParser extends Activity implements OnClickListener {<br /><br /> Button btnStart;<br /> @Override<br /> public void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.main);<br />  btnStart = (Button) findViewById(R.id.button1);<br />  btnStart.setOnClickListener(this);<br /> }<br /><br /> <br /> /// Read plist from Assets<br /> private String readPlistFromAssets() {<br />  StringBuffer sb = new StringBuffer();<br />  BufferedReader br=null;<br />  try {<br />    br = new BufferedReader(new InputStreamReader(getAssets().open("sample.plist"))); <br />   String temp;<br />   while ((temp = br.readLine()) != null)<br />    sb.append(temp);<br />  } catch (IOException e) {<br />   e.printStackTrace();<br />  } finally {<br />   try {<br />    br.close(); // stop reading<br />   } catch (IOException ex) {<br />    ex.printStackTrace();<br />   }<br />  }<br />  return sb.toString();<br /> }<br /><br /><br /> // Start Parsing on Button Click<br /> public void onClick(View v) {<br />  // Read Plist content<br />  String xml = readPlistFromAssets();<br />  // create object of Parser Class<br />  ParsePlist pp = new ParsePlist();<br />  // parse Plist and fill in plist array<br />  ArrayList<datamodel> plist = pp.parsePlist(xml);<br />  // Print ArrayList<br />  Iterator<datamodel> i = plist.iterator();<br />  while(i.hasNext()){<br />   DataModel d = i.next();<br />   Log.i("Plist","=========================");<br />   Log.i("Plist","Date " + d.getDate());<br />   Log.i("Plist","DrawName " + d.getDrawName());<br />   Log.i("Plist","Prize " + d.getPrize());<br />   Log.i("Plist","Sels " + d.getSels());<br />   Log.i("Plist","Draw Id " + d.getDrawId());<br />   Log.i("Plist","Game Id " + d.getGameId());<br />  }<br />  Toast.makeText(this, "Parsing completed please check logcat...", Toast.LENGTH_LONG).show();<br />  <br /> }<br /><br />}<br /></datamodel></datamodel></pre><br />3. DataModel.java - It will store Plist data. you need to modify this class according to your requirement.<br /><br /><pre class="brush: java">package com.kpbird.plist;<br /><br />public class DataModel {<br /> <br /> private int gameId;<br /> private int drawId;<br /> private String drawName;<br /> private String date;<br /> private String prize;<br /> private String sels;<br /> <br /> public int getGameId() {<br />  return gameId;<br /> }<br /> public void setGameId(int gameId) {<br />  this.gameId = gameId;<br /> }<br /> public int getDrawId() {<br />  return drawId;<br /> }<br /> public void setDrawId(int drawId) {<br />  this.drawId = drawId;<br /> }<br /> public String getDrawName() {<br />  return drawName;<br /> }<br /> public void setDrawName(String drawName) {<br />  this.drawName = drawName;<br /> }<br /> public String getDate() {<br />  return date;<br /> }<br /> public void setDate(String date) {<br />  this.date = date;<br /> }<br /> public String getPrize() {<br />  return prize;<br /> }<br /> public void setPrize(String prize) {<br />  this.prize = prize;<br /> }<br /> public String getSels() {<br />  return sels;<br /> }<br /> public void setSels(String sels) {<br />  this.sels = sels;<br /> }<br />}<br /></pre><br />4. ParsePlist.java - Class having method to parse plist. Create object of this class and pass plist content as string in method "parsePlist" It will return ArrayList of DataModel object.<br /><br /><pre class="brush: java">package com.kpbird.plist;<br /><br />import java.io.IOException;<br />import java.io.StringReader;<br />import java.util.ArrayList;<br /><br />import javax.xml.parsers.DocumentBuilder;<br />import javax.xml.parsers.DocumentBuilderFactory;<br />import javax.xml.parsers.ParserConfigurationException;<br /><br />import org.w3c.dom.Document;<br />import org.w3c.dom.Element;<br />import org.w3c.dom.Node;<br />import org.w3c.dom.NodeList;<br />import org.xml.sax.InputSource;<br />import org.xml.sax.SAXException;<br /><br />public class ParsePlist {<br /><br /> <br /> // parse Plist and fill in arraylist<br /> public ArrayList<datamodel> parsePlist(String xml) {<br />  final ArrayList<datamodel> dataModels = new ArrayList<datamodel>();<br />  //Get the xml string from assets<br />  <br />        final Document doc = XMLfromString(xml);<br />        <br />        final NodeList nodes_array = doc.getElementsByTagName("array");<br />  <br />  //Fill in the list items from the XML document<br />  for ( int index = 0; index &lt; nodes_array.getLength(); index++ ) {<br />   <br />   final Node node = nodes_array.item(index);<br />   <br />   if ( node.getNodeType() == Node.ELEMENT_NODE ) {<br />    final Element e = (Element)nodes_array.item(index);<br />    <br />    final NodeList nodeKey = e.getElementsByTagName("key");<br />    final NodeList nodeValue = e.getElementsByTagName("string");<br />    DataModel model = new DataModel();<br />    <br />    for (int i=0; i &lt; nodeValue.getLength(); i++) {<br />     <br />     final Element eleKey = (Element)nodeKey.item(i);<br />     final Element eleString = (Element)noveValue.item(i);<br />     <br />     <br />     if ( eleString != null ) {<br />      <br />      String strValue = getValue(eleString, "string");<br />      <br />      if(getValue(eleKey, "key").equals("gameid")) {<br />       model = new DataModel();<br />       model.setGameId(Integer.parseInt(strValue));<br />      } else if(getValue(eleKey, "key").equals("drawid")) {<br />       model.setDrawId(Integer.parseInt(strValue));<br />      } else if(getValue(eleKey, "key").equals("dname")) {<br />       model.setDrawName(strValue);<br />      } else if(getValue(eleKey, "key").equals("date")) {<br />       model.setDate(strValue);<br />      } else if(getValue(eleKey, "key").equals("prize")) {<br />       model.setPrize(strValue);<br />      } else if(getValue(eleKey, "key").equals("sels")) {<br />       if ( strValue == null ) {<br />        strValue = "";<br />       }<br />       model.setSels(strValue);<br />       dataModels.add(model);<br />      }<br />     }<br />    }<br />   }<br />  }<br />  return dataModels;<br /> }<br /> <br /> // Create xml document object from XML String<br /> private  Document XMLfromString(String xml) {<br />  Document doc = null;<br /><br />  DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();<br />  try {<br />   DocumentBuilder db = dbf.newDocumentBuilder();<br />   InputSource is = new InputSource();<br />   is.setCharacterStream(new StringReader(xml));<br />   doc = db.parse(is);<br />  } catch (ParserConfigurationException e) {<br />   System.out.println("XML parse error: " + e.getMessage());<br />   return null;<br />  } catch (SAXException e) {<br />   System.out.println("Wrong XML file structure: " + e.getMessage());<br />   return null;<br />  } catch (IOException e) {<br />   System.out.println("I/O exeption: " + e.getMessage());<br />   return null;<br />  }<br /><br />  return doc;<br /> }<br /><br /> // fetch value from Text Node only<br /> private   String getElementValue(Node elem) {<br />  Node kid;<br />  if (elem != null) {<br />   if (elem.hasChildNodes()) {<br />    for (kid = elem.getFirstChild(); kid != null; kid = kid.getNextSibling()) {<br />     if (kid.getNodeType() == Node.TEXT_NODE) {<br />      return kid.getNodeValue();<br />     }<br />    }<br />   }<br />  }<br />  return "";<br /> }<br /><br /> /// Fetch value from XML Node<br /> private   String getValue(Element item, String str) {<br />  NodeList n = item.getElementsByTagName(str);<br />  return getElementValue(n.item(0));<br /> }<br />} <br /> <br /><br /></datamodel></datamodel></datamodel></pre></div>