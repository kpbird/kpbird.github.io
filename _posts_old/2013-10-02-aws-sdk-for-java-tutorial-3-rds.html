---
layout: post
title: 'AWS SDK for Java - Tutorial 3 : RDS'
date: '2013-10-02T13:02:00.000+05:30'
author: Ketan Parmar
tags:
- aws sdk
- mysql
- aws java
- rds
- aws
modified_time: '2013-10-02T13:02:43.093+05:30'
thumbnail: http://4.bp.blogspot.com/-XIqcmfy27cE/UkrIeWLRzcI/AAAAAAAAEf4/BCG0JAvAHzM/s72-c/unnamed.png
blogger_id: tag:blogger.com,1999:blog-17114597.post-7312685967877992684
blogger_orig_url: http://www.kpbird.com/2013/10/aws-sdk-for-java-tutorial-3-rds.html
---

<div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-XIqcmfy27cE/UkrIeWLRzcI/AAAAAAAAEf4/BCG0JAvAHzM/s1600/unnamed.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-XIqcmfy27cE/UkrIeWLRzcI/AAAAAAAAEf4/BCG0JAvAHzM/s1600/unnamed.png" /></a></div><br /><b><span style="font-family: Courier New, Courier, monospace;">Introduction</span></b><br /><span style="font-family: Courier New, Courier, monospace;">Amazon Relational Database Service (Amazon RDS) is a web service that makes it easier to set up, operate, and scale a relational database in the cloud. It provides cost-efficient, resizable capacity for an industry-standard relational database and manages common database administration tasks.</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">RDS provides two type of instances 1. On Demand 2. Reserved, We can choose DB Instance type as per requirement, RDS offers micro db instance to the high memory db clusters. We can create MySQL, Oracle or MSSQL server under the RDS services.</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">I suggest to visit previous articles</span><br /><span style="font-family: Courier New, Courier, monospace;">1. <a href="http://www.kpbird.com/2013/09/aws-sdk-for-java-tutorial-1-introduction.html">AWS SDK for Java - Tutorial 1 : Introduction</a></span><br /><span style="font-family: Courier New, Courier, monospace;">2. <a href="http://www.kpbird.com/2013/09/aws-sdk-for-java-tutorial-2-ec2.html">AWS SDK for Java - Tutorial 2 : EC2</a></span><br /><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><span style="font-family: Courier New, Courier, monospace;"><br /></span><b><span style="font-family: Courier New, Courier, monospace;">Classes used to create RDS instance</span></b><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/AmazonRDSClient.html"><span style="font-family: Courier New, Courier, monospace;">AmazonRDSClient</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/CreateDBParameterGroupRequest.html"><span style="font-family: Courier New, Courier, monospace;">CreateDBParameterGroupRequest</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/ModifyDBParameterGroupRequest.html"><span style="font-family: Courier New, Courier, monospace;">ModifyDBParameterGroupRequest</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/CreateDBInstanceRequest.html"><span style="font-family: Courier New, Courier, monospace;">CreateDBInstanceRequest</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/DBInstance.html"><span style="font-family: Courier New, Courier, monospace;">DBInstance</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/DescribeDBInstancesRequest.html"><span style="font-family: Courier New, Courier, monospace;">DescribeDBInstancesRequest</span></a><br /><a href="http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/rds/model/DescribeDBInstancesResult.html"><span style="font-family: Courier New, Courier, monospace;">DescribeDBInstancesResult</span></a><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;"><b>Step1:</b> Define variable requires to create RDS mysql instance, you need to change OwnerId to execute this code</span><br /><pre class="brush:java"> private AmazonRDSClient rdsclient;<br /> //RDS - MySql instance<br /> private String rdsengine = "MySQL";<br /> private String EngineVersion = "5.5.31";<br /> private String LicenseModel = "general-public-license";<br /> private boolean AutoMinorVersionUpgrade = true;<br /> private String DBInstanceClass ="db.t1.micro";<br /> private boolean MultiAZ =false;<br /> private int AllocatedStorage = 25;<br /> <br /> private String DBInstanceIdentifier = "kpbirdrdsmysql";<br /> private String MasterUsername = "kpbird_user";<br /> private String MasterUserPassword = "kpbird_pass";<br /> private String DBName = "kpbirddb";<br /> private int Port = 3306;<br /> private int BackupRetentionPeriod =1;<br /> private boolean PubliclyAccessible = true;<br /> <br /> // db security group parameters<br /> private String DBSecurityGroupName = "kpbirddbsecuritygroup";<br /> private String DBSsecurityGroupDescription = "this is db security group description";<br /> private String OwnerId = "YOUR OWNER ID";<br /> <br /> // db parameter group <br /> private String DBParameterGroupName = "kpbirdrdsparametergroup";<br /> private String DBParameterGroupDescription = "this is db parameter group description";<br /> private String DBParameterGroupFamily = "mysql5.5";<br /> <br /> private String DBParameterName1 = "max_connections";<br /> private String DBParameterValue1 = "200";<br /> private String DBParameterApplyMethod1 = "immediate";<br /> <br /> private String DBParameterName2 = "max_allowed_packet";<br /> private String DBParameterValue2 = "33552384";<br /> private String DBParameterApplyMethod2 = "immediate";<br /></pre><br /><span style="font-family: Courier New, Courier, monospace;"><b>Step 1:</b> Add following code in init method</span><br /><pre class="brush:java">...<br />// RDSClient object<br />rdsclient = new AmazonRDSClient(credentials);<br />rdsclient.setRegion(region);<br />rdsclient.setEndpoint(endPoint);<br />...<br /><br /></pre><br /><span style="font-family: Courier New, Courier, monospace;"><b>Step 2:</b> Create DB Security Group</span><br /><pre class="brush:java">public void createRDSSecurityGroup(){<br />try {<br /> <br /> log.Info("About to Launch RDS");<br /> <br /> CreateDBSecurityGroupRequest d = new CreateDBSecurityGroupRequest();<br /> d.setDBSecurityGroupName(DBSecurityGroupName);<br /> d.setDBSecurityGroupDescription(DBSsecurityGroupDescription);<br /> rdsclient.createDBSecurityGroup(d);<br /> <br /> <br /> AuthorizeDBSecurityGroupIngressRequest auth = new AuthorizeDBSecurityGroupIngressRequest();<br /> auth.setDBSecurityGroupName(DBSecurityGroupName);<br /> auth.setEC2SecurityGroupName(groupName);<br /> auth.setEC2SecurityGroupOwnerId(OwnerId);<br /> <br /> <br /> DBSecurityGroup dbsecuritygroup= rdsclient.authorizeDBSecurityGroupIngress(auth);<br /> <br /> } catch (Exception e) {<br />  e.printStackTrace();<br />  System.exit(0);<br /> }<br />}<br /></pre><br /><span style="font-family: Courier New, Courier, monospace;"><b>Step 3:</b> Create DB Instance</span><br /><pre class="brush:java">public void createRDS(){<br />try {<br /> log.Info("About to Launch RDS");<br />  <br />  <br /> log.Info("Createing DB Parameger Group");<br /> <br /> CreateDBParameterGroupRequest cdpgr = new CreateDBParameterGroupRequest();<br /> cdpgr.setDBParameterGroupName(DBParameterGroupName);<br /> cdpgr.setDescription(DBParameterGroupDescription);<br /> cdpgr.setDBParameterGroupFamily(DBParameterGroupFamily);<br /> rdsclient.createDBParameterGroup(cdpgr);<br /> <br /> <br /> Collection&lt;Parameter&gt; parameters = new ArrayList&lt;Parameter&gt;();<br /> parameters.add( new Parameter()<br />            .withParameterName(DBParameterName1)<br />            .withParameterValue(DBParameterValue1)<br />            .withApplyMethod(DBParameterApplyMethod1));<br /> parameters.add( new Parameter()<br />            .withParameterName(DBParameterName2)<br />            .withParameterValue(DBParameterValue2)<br />            .withApplyMethod(DBParameterApplyMethod2));<br /><br /><br /> rdsclient.modifyDBParameterGroup( new ModifyDBParameterGroupRequest().withDBParameterGroupName(DBParameterGroupName).withParameters(parameters));<br /><br /><br /> log.Info("Create DB Instance Request");<br /> /// create configuration of instance<br /> CreateDBInstanceRequest cdbir = new CreateDBInstanceRequest();<br /> cdbir.setEngine(rdsengine);<br /> cdbir.setEngineVersion(EngineVersion);<br /> cdbir.setLicenseModel(LicenseModel);<br /> cdbir.setAutoMinorVersionUpgrade(AutoMinorVersionUpgrade);<br /> cdbir.setDBInstanceClass(DBInstanceClass);<br /> cdbir.setMultiAZ(MultiAZ);<br /> cdbir.setAllocatedStorage(AllocatedStorage);<br /> cdbir.setDBInstanceIdentifier(DBInstanceIdentifier);<br /> cdbir.setMasterUsername(MasterUsername);<br /> cdbir.setMasterUserPassword(MasterUserPassword);<br /> cdbir.setDBName(DBName);<br /> cdbir.setPort(Port);<br /> cdbir.setBackupRetentionPeriod(BackupRetentionPeriod);<br /> cdbir.setPubliclyAccessible(PubliclyAccessible);<br /> cdbir.setDBParameterGroupName(DBParameterGroupName);<br /> ArrayList&lt;String&gt; arrDbSecur = new ArrayList&lt;String&gt;();<br /> arrDbSecur.add(DBSecurityGroupName);<br /> cdbir.setDBSecurityGroups(arrDbSecur);<br />  <br /> log.Info("Creating RDS DB Instance");<br /> // creating instance<br /> DBInstance dbi=  rdsclient.createDBInstance(cdbir);<br /> <br /> // wait till instance created<br /> boolean isWaiting = true;<br /> while(isWaiting){<br />  Thread.sleep(5000);<br />  DescribeDBInstancesRequest request = new DescribeDBInstancesRequest();<br />  request.setDBInstanceIdentifier(dbi.getDBInstanceIdentifier());<br />  DescribeDBInstancesResult result = rdsclient.describeDBInstances(request);<br />  List&lt;DBInstance&gt; d= result.getDBInstances();<br />  Iterator&lt;DBInstance&gt; i = d.iterator();<br />  <br />  while(i.hasNext()){<br />   DBInstance d1 = i.next();<br />   log.Info("RDS Status : " + d1.getDBInstanceStatus());<br />   if(d1.getDBInstanceStatus().equals("available")){<br />    isWaiting = false;<br />    log.Info("RDS Endpoint : " + d1.getEndpoint().getAddress());<br />   }<br />  }<br /> }<br /> } catch (Exception e) {<br />  e.printStackTrace();<br />  System.exit(0);<br /> }<br />}<br /></pre><br /><span style="font-family: Courier New, Courier, monospace;"><b>Screen Shots</b></span><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-Hh9NFq679bE/UkvH88qmN4I/AAAAAAAAEgQ/VzZZFuZck_c/s1600/DB+Security+Group.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="136" src="http://4.bp.blogspot.com/-Hh9NFq679bE/UkvH88qmN4I/AAAAAAAAEgQ/VzZZFuZck_c/s640/DB+Security+Group.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">DB Security Group</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-NkKc76iYC90/UkvH8tGVlZI/AAAAAAAAEgM/_92MAtEyMtY/s1600/Parameger+Group.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="140" src="http://4.bp.blogspot.com/-NkKc76iYC90/UkvH8tGVlZI/AAAAAAAAEgM/_92MAtEyMtY/s640/Parameger+Group.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">DB Parameter Group</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-0y6Xm1TmvrM/UkvH869LQmI/AAAAAAAAEgU/12oU-Z5K72s/s1600/RDS+Instance.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="168" src="http://3.bp.blogspot.com/-0y6Xm1TmvrM/UkvH869LQmI/AAAAAAAAEgU/12oU-Z5K72s/s640/RDS+Instance.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">RDS Instance</td></tr></tbody></table><br /><a href="https://github.com/kpbird/AWS-EC2-Java-Tutorial"><b><span style="font-family: Courier New, Courier, monospace;">Click here to download full source</span></b></a><br /><br />