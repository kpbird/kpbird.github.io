---
layout: post
title: Android Chips EditText , Token EditText and Bubble EditText - [Part 1]
date: '2013-02-12T11:24:00.001+05:30'
author: Ketan Parmar
tags:
- Chips edit text
- bubble edit text
- Android
- contact bubble edit text
- token edit text
- gmail like field
modified_time: '2013-02-26T13:09:38.238+05:30'
thumbnail: http://3.bp.blogspot.com/-eQFM2rHqN2E/URjCWehucUI/AAAAAAAADsk/24uoQcIv5Mo/s72-c/device-2013-02-11-150420.png
blogger_id: tag:blogger.com,1999:blog-17114597.post-1360334741197522381
blogger_orig_url: http://www.kpbird.com/2013/02/android-chips-edittext-token-edittext.html
---

<span style="font-family: Verdana, sans-serif;">Chips EditText, Token EditText, Bubble EditText, Spannable EditText and etc.. There are many names of this control. Whatever we call it but this control is not available in Android. I found many questions and solutions for this control.&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;"><b>Few popular questions &amp; solutions&nbsp;</b></span><br /><span style="font-family: Verdana, sans-serif;">1] Roman Nurik : <a href="https://plus.google.com/113735310430199015092/posts/WUd7GrfZfiZ">https://plus.google.com/113735310430199015092/posts/WUd7GrfZfiZ</a>&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;">2] Android EditText Gmail like Field : <a href="http://stackoverflow.com/questions/13747809/android-edittext-gmail-like-to-field">http://stackoverflow.com/questions/13747809/android-edittext-gmail-like-to-field</a>&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;">3] Android Labels or Bubbles in Edit Text : <a href="http://stackoverflow.com/questions/8090711/android-labels-or-bubbles-in-edittext/8128848#8128848">http://stackoverflow.com/questions/8090711/android-labels-or-bubbles-in-edittext/8128848#8128848</a>&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;">4] Contact Bubble Edit Text : <a href="http://stackoverflow.com/questions/10812316/contact-bubble-edittext">http://stackoverflow.com/questions/10812316/contact-bubble-edittext</a>&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">While I was reading above post, I thought that, I should develop Chips Edit Text control, which should be easy to understand and integrated in project.   Here, My control is named as "Chips Edit Text". Before going to technical details, I would like to show few screenshots.</span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-eQFM2rHqN2E/URjCWehucUI/AAAAAAAADsk/24uoQcIv5Mo/s1600/device-2013-02-11-150420.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-eQFM2rHqN2E/URjCWehucUI/AAAAAAAADsk/24uoQcIv5Mo/s320/device-2013-02-11-150420.png" width="192" /></a></div>&nbsp;<a href="http://3.bp.blogspot.com/-NyoWsN72qsc/URjCWsk28cI/AAAAAAAADso/kVb05tbAb6M/s1600/device-2013-02-11-150434.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="320" src="http://3.bp.blogspot.com/-NyoWsN72qsc/URjCWsk28cI/AAAAAAAADso/kVb05tbAb6M/s320/device-2013-02-11-150434.png" width="192" /></a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-zw49PcZALls/URjCWaQhiuI/AAAAAAAADss/mmjCh62eaNk/s1600/device-2013-02-11-150452.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-zw49PcZALls/URjCWaQhiuI/AAAAAAAADss/mmjCh62eaNk/s320/device-2013-02-11-150452.png" width="192" /></a></div>&nbsp;<a href="http://4.bp.blogspot.com/-UbYkEsvo_sA/URjCXD6rf-I/AAAAAAAADs4/vIEa_MiiAu4/s1600/device-2013-02-11-150502.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="320" src="http://4.bp.blogspot.com/-UbYkEsvo_sA/URjCXD6rf-I/AAAAAAAADs4/vIEa_MiiAu4/s320/device-2013-02-11-150502.png" width="192" /></a><br /><br /><br /><b><span style="font-family: Verdana, sans-serif;">Step 1: Prerequisite</span></b><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">Android provides bunch of Span classes, Span classes are used to format text. I suggest to read following articles for helpful detail and in-depth understanding.</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">1] Introduction to Span</span><br /><span style="font-family: Verdana, sans-serif;"><a href="http://blog.stylingandroid.com/archives/177">http://blog.stylingandroid.com/archives/177</a></span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">2] Easy Method for Formatting Android</span><br /><span style="font-family: Verdana, sans-serif;"><a href="http://www.androidengineer.com/2010/08/easy-method-for-formatting-android.html">http://www.androidengineer.com/2010/08/easy-method-for-formatting-android.html</a></span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">3] API Classes : <a href="http://developer.android.com/reference/android/text/Spannable.html" target="_blank">Spannable</a>, <a href="http://developer.android.com/reference/android/text/SpannableString.html" target="_blank">SpannableString</a>, <a href="http://developer.android.com/reference/android/text/SpannableStringBuilder.html" target="_blank">SpannableStringBuilder</a>, <a href="http://developer.android.com/reference/android/text/style/ImageSpan.html" target="_blank">ImageSpan</a>&nbsp;,<a href="http://developer.android.com/reference/android/text/style/ClickableSpan.html" target="_blank">ClickableSpan</a>&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;"><b>Step 2 : Logic</b></span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">Our goal is to display background (border &amp; fill with color) and image at right side of every chip. Android spannable classes allow us to set background color only. It does not support any drawable at background. Another problem is right side image. Android has ImageSpan class, we can display image at right side with ImageSpan but problem is that ImageSpan will consider as separate entity and it will display outside of background.</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">I have implemented following logic to overcome above two problems</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">1. Extends MultiAutoCompleteTextView to create chips edit text.</span><br /><span style="font-family: Verdana, sans-serif;">2. Generate TextView dynamically in code and set style &amp; drawable at right side.</span><br /><span style="font-family: Verdana, sans-serif;">3. Capture image/bitmap of newly generated TextView.</span><br /><span style="font-family: Verdana, sans-serif;">4. Set ImageSpan&nbsp;instead-of country name.&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;"><b>Step 3 : Create Android Project</b></span><br /><br /><span style="font-family: Verdana, sans-serif;">Create Android project named "Chips Edit Text"&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><b><br /></b></span><span style="font-family: Verdana, sans-serif;"><b>Step 4 : Create class named "</b>ChipsMultiAutoCompleteTextview.java"</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><br /><pre class="brush: java">package com.kpbird.chipsedittext;<br /><br />import android.app.Activity;<br />import android.content.Context;<br />import android.graphics.Bitmap;<br />import android.graphics.Canvas;<br />import android.graphics.drawable.BitmapDrawable;<br />import android.text.Editable;<br />import android.text.Spannable;<br />import android.text.SpannableStringBuilder;<br />import android.text.TextWatcher;<br />import android.text.style.ImageSpan;<br />import android.util.AttributeSet;<br />import android.util.Log;<br />import android.view.LayoutInflater;<br />import android.view.View;<br />import android.widget.AdapterView;<br />import android.widget.AdapterView.OnItemClickListener;<br />import android.widget.MultiAutoCompleteTextView;<br />import android.widget.TextView;<br /><br />public class ChipsMultiAutoCompleteTextview extends MultiAutoCompleteTextView implements OnItemClickListener {<br /><br /> private final String TAG = "ChipsMultiAutoCompleteTextview";<br /> <br /> // Constructor <br /> public ChipsMultiAutoCompleteTextview(Context context) {<br />  super(context);<br />  init(context);<br /> }<br /> // Constructor <br /> public ChipsMultiAutoCompleteTextview(Context context, AttributeSet attrs) {<br />  super(context, attrs);<br />  init(context);<br /> }<br /> // Constructor <br /> public ChipsMultiAutoCompleteTextview(Context context, AttributeSet attrs,<br />   int defStyle) {<br />  super(context, attrs, defStyle);<br />  init(context);<br /> }<br /> // set listeners for item click and text change <br /> public void init(Context context){<br />  setOnItemClickListener(this);<br />  addTextChangedListener(textWather);<br /> }<br /> // TextWatcher, If user type any country name and press comma then following code will regenerate chips <br /> private TextWatcher textWather = new TextWatcher() {<br />  <br />  @Override<br />  public void onTextChanged(CharSequence s, int start, int before, int count) {<br />   if(count &gt;=1){<br />    if(s.charAt(start) == ',')<br />     setChips(); // generate chips<br />   }<br />  }<br />  @Override<br />  public void beforeTextChanged(CharSequence s, int start, int count,int after) {}<br />  @Override<br />  public void afterTextChanged(Editable s) {}<br /> };<br /> //This function has whole logic for chips generate<br /> public void setChips(){<br />  if(getText().toString().contains(",")) // check comman in string<br />  {<br />   <br />   SpannableStringBuilder ssb = new SpannableStringBuilder(getText());<br />   // split string wich comma<br />   String chips[] = getText().toString().trim().split(",");<br />   int x =0;<br />   // loop will generate ImageSpan for every country name separated by comma<br />   for(String c : chips){<br />    // inflate chips_edittext layout <br />    LayoutInflater lf = (LayoutInflater) getContext().getSystemService(Activity.LAYOUT_INFLATER_SERVICE);<br />    TextView textView = (TextView) lf.inflate(R.layout.chips_edittext, null);<br />    textView.setText(c); // set text<br />    setFlags(textView, c); // set flag image<br />    // capture bitmapt of genreated textview<br />    int spec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);<br />    textView.measure(spec, spec);<br />    textView.layout(0, 0, textView.getMeasuredWidth(), textView.getMeasuredHeight());<br />    Bitmap b = Bitmap.createBitmap(textView.getWidth(), textView.getHeight(),Bitmap.Config.ARGB_8888);<br />    Canvas canvas = new Canvas(b);<br />    canvas.translate(-textView.getScrollX(), -textView.getScrollY());<br />    textView.draw(canvas);<br />    textView.setDrawingCacheEnabled(true);<br />    Bitmap cacheBmp = textView.getDrawingCache();<br />    Bitmap viewBmp = cacheBmp.copy(Bitmap.Config.ARGB_8888, true);<br />    textView.destroyDrawingCache();  // destory drawable<br />    // create bitmap drawable for imagespan<br />    BitmapDrawable bmpDrawable = new BitmapDrawable(viewBmp);<br />    bmpDrawable.setBounds(0, 0,bmpDrawable.getIntrinsicWidth(),bmpDrawable.getIntrinsicHeight());<br />    // create and set imagespan <br />    ssb.setSpan(new ImageSpan(bmpDrawable),x ,x + c.length() , Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);<br />    x = x+ c.length() +1;<br />   }<br />   // set chips span <br />   setText(ssb);<br />   // move cursor to last <br />   setSelection(getText().length());<br />  }<br />  <br />  <br /> }<br /> @Override<br /> public void onItemClick(AdapterView parent, View view, int position, long id) {<br />  setChips(); // call generate chips when user select any item from auto complete<br /> }<br /> <br /> // this method set country flag image in textview's drawable component, this logic is not optimize, you need to change as per your requirement<br /> public void setFlags(TextView textView,String country){<br />  country = country.trim();<br />  if(country.equals("India")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.india, 0);<br />  }<br />  else if(country.equals("United States")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.unitedstates, 0);<br />  }<br />  else if(country.equals("Canada")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.canada, 0);<br />  }<br />  else if(country.equals("Australia")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.australia, 0);<br />  }<br />  else if(country.equals("United Kingdom")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.unitedkingdom, 0);<br />  }<br />  else if(country.equals("Philippines")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.philippines, 0);<br />  }<br />  else if(country.equals("Japan")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.japan, 0);<br />  }<br />  else if(country.equals("Italy")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.japan, 0);<br />  }<br />  else if(country.equals("Germany")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.germany, 0);<br />  }<br />  else if(country.equals("Russia")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.russia, 0);<br />  }<br />  else if(country.equals("Malaysia")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.malaysia, 0);<br />  }<br />  else if(country.equals("France")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.france, 0);<br />  }<br />  else if(country.equals("Sweden")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.sweden, 0);<br />  }<br />  else if(country.equals("New Zealand")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.newzealand, 0);<br />  }<br />  else if(country.equals("Singapore")){<br />   textView.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.singapore, 0);<br />  }<br />  <br />  <br /> }<br /> <br />}<br /></pre><br /><b style="font-family: Verdana, sans-serif;">Step 5 : Create drawable shape for chip named "chips_edittext_bg.xml" in drawable folder.</b><br /><b style="font-family: Verdana, sans-serif;"><br /></b> <br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;shape xmlns:android="http://schemas.android.com/apk/res/android" &gt;<br /><br />    &lt;stroke<br />        android:width="1dp"<br />        android:color="#A6B0B8" /&gt;<br /><br />    &lt;solid android:color="#E5E5E6" /&gt;<br /><br />    &lt;corners<br />        android:bottomLeftRadius="3dp"<br />        android:bottomRightRadius="3dp"<br />        android:topLeftRadius="3dp"<br />        android:topRightRadius="3dp" &gt;<br />    &lt;/corners&gt;<br /><br />&lt;/shape&gt;<br /></pre><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;">Step 6 : Create TextView layout for chip named "chips_edittext.xml" in layout folder</b><br /><b style="font-family: Verdana, sans-serif;"><br /></b><br /><pre class="brush: xml"> &lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;TextView xmlns:android="http://schemas.android.com/apk/res/android"<br />    android:id="@+id/edtTxt1"<br />    android:layout_width="wrap_content"<br />    android:layout_height="wrap_content"<br />    android:background="@drawable/chips_edittext_gb"<br />    android:drawablePadding="2dp"<br />    android:drawableRight="@drawable/android"<br />    android:padding="8dp"<br />    android:shadowColor="#FFFFFF"<br />    android:shadowDy="1"<br />    android:shadowRadius="0.01"<br />    android:textColor="#000000"<br />    android:textSize="18sp"<br />    android:textStyle="bold" /&gt;<br /></pre><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;">Step 7 : Create string array for multi select data named "country" in strings.xml&nbsp;</b><br /><b style="font-family: Verdana, sans-serif;"><br /></b><br /><pre class="brush: xml">    &lt;string-array name="country"&gt;<br />        &lt;item &gt;India&lt;/item&gt;<br />        &lt;item&gt;United States&lt;/item&gt;<br />        &lt;item&gt;Canada&lt;/item&gt;<br />        &lt;item&gt;Australia&lt;/item&gt;<br />        &lt;item&gt;United Kingdom&lt;/item&gt;<br />        &lt;item&gt;Philippines&lt;/item&gt;<br />        &lt;item &gt;Japan&lt;/item&gt;<br />        &lt;item&gt;Italy&lt;/item&gt;<br />        &lt;item&gt;Germany&lt;/item&gt;<br />        &lt;item&gt;Russia&lt;/item&gt;<br />        &lt;item&gt;Malaysia&lt;/item&gt;<br />        &lt;item&gt;France&lt;/item&gt;<br />        &lt;item&gt;Sweden&lt;/item&gt;<br />        &lt;item&gt;New Zealand&lt;/item&gt;<br />        &lt;item&gt;Singapore&lt;/item&gt;<br />    &lt;/string-array&gt;<br /></pre><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;">Step 8 : Edit layout of main_activity.xml file</b><br /><b style="font-family: Verdana, sans-serif;"><br /></b><br /><pre class="brush: xml">&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:tools="http://schemas.android.com/tools"<br />    android:layout_width="match_parent"<br />    android:layout_height="match_parent"<br />    tools:context=".MainActivity" &gt;<br />    &lt;com.kpbird.chipsedittext.ChipsMultiAutoCompleteTextview<br />         android:id="@+id/multiAutoCompleteTextView1"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:layout_alignParentLeft="true"<br />        android:layout_alignParentRight="true"<br />        android:layout_alignParentTop="true"<br />        android:ems="10"<br />         /&gt;<br />    &lt;Button<br />        android:id="@+id/button1"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:layout_alignParentLeft="true"<br />        android:layout_alignParentRight="true"<br />        android:layout_below="@+id/multiAutoCompleteTextView1"<br />        android:onClick="buttonClicked"<br />        android:text="@string/getvalue" /&gt;<br />    &lt;TextView<br />        android:id="@+id/textView1"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:layout_alignParentLeft="true"<br />        android:layout_alignParentRight="true"<br />        android:layout_below="@+id/button1"<br />        android:text="@string/selectedcountries"<br />        android:textAppearance="?android:attr/textAppearanceLarge" /&gt;<br /><br />&lt;/RelativeLayout&gt;<br /></pre><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;">Step 9 : Edit code of mainactivity.java file</b><br /><b style="font-family: Verdana, sans-serif;"><br /></b><br /><pre class="brush: java">package com.kpbird.chipsedittext;<br /><br />import android.app.Activity;<br />import android.os.Bundle;<br />import android.util.Log;<br />import android.view.View;<br />import android.widget.ArrayAdapter;<br />import android.widget.MultiAutoCompleteTextView;<br />import android.widget.TextView;<br /><br />public class MainActivity extends Activity {<br /><br /> ChipsMultiAutoCompleteTextview mu;<br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br /><br />  mu = (ChipsMultiAutoCompleteTextview) findViewById(R.id.multiAutoCompleteTextView1);<br /><br />  String[] item = getResources().getStringArray(R.array.country);<br /><br />  Log.i("", "Country Count : " + item.length);<br />  mu.setAdapter(new ArrayAdapter<string>(this,<br />    android.R.layout.simple_dropdown_item_1line, item));<br />  mu.setTokenizer(new MultiAutoCompleteTextView.CommaTokenizer());<br /> }<br /><br /> public void buttonClicked(View v) {<br />  TextView tv = (TextView) findViewById(R.id.textView1);<br />  tv.setText(mu.getText().toString());<br /> }<br /><br />}<br /><br /></string></pre><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;"><br /></b><b style="font-family: Verdana, sans-serif;"><br /></b><br /><b style="font-family: Verdana, sans-serif;">Source code : <a href="https://github.com/kpbird/chipsedittext" target="_blank">Github Link</a></b><br /><span style="font-family: Verdana, sans-serif;">&nbsp; &nbsp;&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span>