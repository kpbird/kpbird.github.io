---
layout: post
title: 'Android : Login with Facebook SDK 3.0  '
date: '2013-03-18T14:15:00.000+05:30'
author: Ketan Parmar
tags:
- facebook sdk 3.0
- facebook
- facebook sdk
- Android
- facebook email
- facebook login
modified_time: '2013-03-18T14:16:51.310+05:30'
thumbnail: http://3.bp.blogspot.com/-8lbM6rzd_Xc/UUatW2PGf0I/AAAAAAAADyk/kROivvO64D4/s72-c/facebook_1.png
blogger_id: tag:blogger.com,1999:blog-17114597.post-6682188512529802532
blogger_orig_url: http://www.kpbird.com/2013/03/android-login-using-facebook-sdk-30.html
---

<b><span style="font-family: Verdana, sans-serif;"><br /></span></b><b><span style="font-family: Verdana, sans-serif;">Introduction</span></b><br /><span style="font-family: Verdana, sans-serif;">The goal of this article is explain&nbsp;simplest way to use Facebook for Login and fetch user details including </span><b style="font-family: Verdana, sans-serif;">Email Address.</b><span style="font-family: Verdana, sans-serif;">&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">The Facebook SDK for Android is the easiest way to integrate your Android app with Facebook's platform.&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">What's new in Facebook SDK 3.0</span><br /><ul><li><span style="font-family: Verdana, sans-serif;">Simplified user session management</span></li><li><span style="font-family: Verdana, sans-serif;">Better Facebook APIs support</span></li><li><span style="font-family: Verdana, sans-serif;">Ready-to-Use native UI views</span></li><li><span style="font-family: Verdana, sans-serif;">Mobile install measurement</span></li></ul><b><span style="font-family: Verdana, sans-serif;">Prerequisite</span></b><br /><span style="font-family: Verdana, sans-serif;">1. Facebook Android SDK 3.0 - <a href="https://developers.facebook.com/resources/facebook-android-sdk-3.0.zip" target="_blank">Download</a></span><br /><span style="font-family: Verdana, sans-serif;">2. Facebook API Key from Facebook Application - <a href="https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/" target="_blank">Detail</a></span><br /><span style="font-family: Verdana, sans-serif;">3. Hash Key of your debug certificate &nbsp;- <a href="http://sonyarouje.com/2011/09/18/facebook-hash-key-for-android-apps/" target="_blank">Detail</a></span><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-8lbM6rzd_Xc/UUatW2PGf0I/AAAAAAAADyk/kROivvO64D4/s1600/facebook_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-8lbM6rzd_Xc/UUatW2PGf0I/AAAAAAAADyk/kROivvO64D4/s320/facebook_1.png" width="180" /></a><a href="http://1.bp.blogspot.com/-BchIE0fDlbQ/UUatYglexGI/AAAAAAAADzA/3VK9giaS6nI/s1600/facebook_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/-BchIE0fDlbQ/UUatYglexGI/AAAAAAAADzA/3VK9giaS6nI/s320/facebook_2.png" width="180" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-8ReTeQd7lME/UUatYx70jhI/AAAAAAAADzE/HuiKLXagVyk/s1600/facebook_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/-8ReTeQd7lME/UUatYx70jhI/AAAAAAAADzE/HuiKLXagVyk/s320/facebook_3.png" width="180" /></a><a href="http://3.bp.blogspot.com/-6cDkF2Jl0F4/UUatYMP3M2I/AAAAAAAADy0/qO1NOL3ffYk/s1600/facebook_4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-6cDkF2Jl0F4/UUatYMP3M2I/AAAAAAAADy0/qO1NOL3ffYk/s320/facebook_4.png" width="180" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><span style="font-family: Verdana, sans-serif;">Step 1 : Create Android Project named "FacebookTest"</span><br /><span style="font-family: Verdana, sans-serif;">Step 2 : Import FacebookSDK in eclipse</span><br /><span style="font-family: Verdana, sans-serif;">Step 3 : Add Reference of Facebook SDK in FacebookTest Project</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><a href="http://1.bp.blogspot.com/-ajYQSf1izzQ/UUatWtpUq1I/AAAAAAAADyY/PLy3-vpQQHo/s1600/Screen+Shot+2013-03-18+at+11.02.12+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="400" src="http://1.bp.blogspot.com/-ajYQSf1izzQ/UUatWtpUq1I/AAAAAAAADyY/PLy3-vpQQHo/s400/Screen+Shot+2013-03-18+at+11.02.12+AM.png" width="200" /></a><a href="http://3.bp.blogspot.com/-ZejSgFSA90Y/UUatXJGucQI/AAAAAAAADyo/qjJxELty5ww/s1600/Screen+Shot+2013-03-18+at+11.02.25+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="400" src="http://3.bp.blogspot.com/-ZejSgFSA90Y/UUatXJGucQI/AAAAAAAADyo/qjJxELty5ww/s400/Screen+Shot+2013-03-18+at+11.02.25+AM.png" width="261" /></a><br /><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">Step 4 : Add app_id in strings.xml, replace your facebook api key in following code.</span><br /><br /><pre class="brush:xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;resources&gt;<br /><br />    &lt;string name="app_name"&gt;FacebookTest&lt;/string&gt;<br />    &lt;string name="action_settings"&gt;Settings&lt;/string&gt;<br />    &lt;string name="hello_world"&gt;Hello world!&lt;/string&gt;<br />    &lt;string name="app_id"&gt;YOUR_FACEBOOK_API_KEY&lt;/string&gt;<br /><br />&lt;/resources&gt;</pre><pre class="brush:xml"></pre><span style="font-family: Verdana, sans-serif;">Step 5 : Add meta-date tag and LoginActivity in AndroidManifest.xml. In this demo I am using LoginButton provided by Facebook SDK, It is also possible to user our native Button for Login. We also require to register LoginActivity. LoginActivity &amp; LoginButton are available in Facebook SDK.</span><br /><pre class="brush:xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br />    package="com.kpbird.facebooktest"<br />    android:versionCode="1"<br />    android:versionName="1.0" &gt;<br />    &lt;uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17" /&gt;<br />    &lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br />    &lt;application<br />        android:allowBackup="true"<br />        android:icon="@drawable/ic_launcher"<br />        android:label="@string/app_name"<br />        android:theme="@style/AppTheme" &gt;<br />        &lt;activity<br />            android:name="com.kpbird.facebooktest.MainActivity"<br />            android:label="@string/app_name" &gt;<br />            &lt;intent-filter&gt;<br />                &lt;action android:name="android.intent.action.MAIN" /&gt;<br />                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br />            &lt;/intent-filter&gt;<br />        &lt;/activity&gt;<br />         &lt;activity android:name="com.facebook.LoginActivity"<br />           android:theme="@android:style/Theme.Translucent.NoTitleBar"<br />           android:label="@string/app_name" /&gt;<br />         &lt;meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/&gt;<br />    &lt;/application&gt;<br />&lt;/manifest&gt;<br /></pre><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">Step 6 : Add Facebook Login button in activity_main.xml, Main activity contains TextView and LoginButton. TextView will display user's email address.</span><br /><pre class="brush:xml">&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:tools="http://schemas.android.com/tools"<br />    android:layout_width="match_parent"<br />    android:layout_height="match_parent"<br />    tools:context=".MainActivity" &gt;<br /><br />     &lt;TextView<br />         android:id="@+id/lblEmail"<br />         android:layout_width="wrap_content"<br />         android:layout_height="wrap_content"<br />         android:layout_alignParentTop="true"<br />         android:layout_centerHorizontal="true"<br />         android:layout_marginTop="144dp"<br />         android:text="Email ID : "<br />         android:textAppearance="?android:attr/textAppearanceLarge" /&gt;<br /><br />&lt;com.facebook.widget.LoginButton<br />         android:id="@+id/authButton"<br />         android:layout_width="wrap_content"<br />         android:layout_height="wrap_content"<br />         android:layout_alignParentTop="true"<br />         android:layout_centerHorizontal="true"<br />         android:layout_marginTop="45dp" /&gt;<br /><br />&lt;/RelativeLayout&gt;<br /></pre><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">Step 7 : Open MainActivity.java and write following code. Following is very simple code, you just need to take few importent things&nbsp;</span><br /><ul><li><span style="font-family: Verdana, sans-serif;">Override onActivityResult to get LoginButton Events</span></li><li><span style="font-family: Verdana, sans-serif;">Set permission as per your requirement</span></li><li><span style="font-family: Verdana, sans-serif;">executeMe request to fetch user detail and email</span></li><li><span style="font-family: Verdana, sans-serif;">fetch email address from user object</span></li></ul><pre class="brush:java">package com.kpbird.facebooktest;<br /><br />import java.util.Arrays;<br /><br />import android.app.Activity;<br />import android.content.Intent;<br />import android.os.Bundle;<br />import android.util.Log;<br />import android.view.View;<br />import android.widget.TextView;<br /><br />import com.facebook.FacebookException;<br />import com.facebook.Request;<br />import com.facebook.Response;<br />import com.facebook.Session;<br />import com.facebook.SessionState;<br />import com.facebook.model.GraphUser;<br />import com.facebook.widget.LoginButton;<br />import com.facebook.widget.LoginButton.OnErrorListener;<br /><br />public class MainActivity extends Activity {<br /><br /> private String TAG = "MainActivity";<br /> private TextView lblEmail;<br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  lblEmail = (TextView) findViewById(R.id.lblEmail);<br />  <br />  LoginButton authButton = (LoginButton) findViewById(R.id.authButton);<br />  authButton.setOnErrorListener(new OnErrorListener() {<br />   <br />   @Override<br />   public void onError(FacebookException error) {<br />    Log.i(TAG, "Error " + error.getMessage());<br />   }<br />  });<br />  // set permission list, Don't foeget to add email<br />  authButton.setReadPermissions(Arrays.asList("basic_info","email"));<br />  // session state call back event<br />  authButton.setSessionStatusCallback(new Session.StatusCallback() {<br />   <br />   @Override<br />   public void call(Session session, SessionState state, Exception exception) {<br />    <br />    if (session.isOpened()) {<br />              Log.i(TAG,"Access Token"+ session.getAccessToken());<br />              Request.executeMeRequestAsync(session,<br />                      new Request.GraphUserCallback() {<br />                          @Override<br />                          public void onCompleted(GraphUser user,Response response) {<br />                              if (user != null) { <br />                               Log.i(TAG,"User ID "+ user.getId());<br />                               Log.i(TAG,"Email "+ user.asMap().get("email"));<br />                               lblEmail.setText(user.asMap().get("email").toString());<br />                              }<br />                          }<br />                      });<br />          }<br />    <br />   }<br />  });<br /> }<br /><br /> @Override<br /> public void onActivityResult(int requestCode, int resultCode, Intent data) {<br />     super.onActivityResult(requestCode, resultCode, data);<br />     Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);<br /> }<br /> <br /><br />}<br /><br /></pre><br /><span style="font-family: Verdana, sans-serif;"><b>Change Login/Logout text of LoginButton.</b></span><br /><pre class="brush:xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:fb="http://schemas.android.com/apk/res-auto"<br />    android:layout_width="match_parent"<br />    android:layout_height="match_parent" &gt;<br /><br />    &lt;com.facebook.widget.LoginButton<br />         android:id="@+id/activity_login_facebook_btn_login"<br />         android:layout_width="300dp"<br />        android:layout_height="wrap_content"<br />        android:layout_alignParentBottom="true"<br />        android:layout_centerHorizontal="true"<br />        android:layout_marginBottom="15dp"<br />        fb:login_text="Login with Facebook"<br />     fb:logout_text="Logout"<br />         /&gt;<br /><br />&lt;/RelativeLayout&gt;<br /></pre><br /><b>Read More</b><br /><br /><ul><li><a href="http://developers.facebook.com/features/whats-new-android-sdk-3.0/" target="_blank">What's New in Facebook SDK 3.0</a></li><li><a href="https://developers.facebook.com/docs/tutorials/androidsdk/3.0/upgrading-from-2.0-to-3.0/" target="_blank">Upgrading from 2.0 to 3.0</a></li><li><a href="http://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/" target="_blank">Authenticate</a></li><li><a href="http://developers.facebook.com/docs/reference/android/3.0/LoginButton" target="_blank">LoginButton</a></li></ul><br /><br />